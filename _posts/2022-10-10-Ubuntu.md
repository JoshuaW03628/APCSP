---
keywords: fastai
title: Title
nb_path: _notebooks/2022-10-10-Ubuntu.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-10-10-Ubuntu.ipynb
-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">polygon</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="n">client</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Requirement already satisfied: polygon-api-client in /Users/josh/opt/anaconda3/lib/python3.9/site-packages (1.3.1)
Requirement already satisfied: websockets&lt;11.0,&gt;=10.3 in /Users/josh/opt/anaconda3/lib/python3.9/site-packages (from polygon-api-client) (10.3)
Requirement already satisfied: urllib3&lt;2.0.0,&gt;=1.26.9 in /Users/josh/opt/anaconda3/lib/python3.9/site-packages (from polygon-api-client) (1.26.9)
Requirement already satisfied: certifi&lt;2023.0.0,&gt;=2022.5.18 in /Users/josh/opt/anaconda3/lib/python3.9/site-packages (from polygon-api-client) (2022.9.24)
Note: you may need to restart the kernel to use updated packages.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">polygon</span> <span class="kn">import</span> <span class="n">RESTClient</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="n">RESTClient</span><span class="p">(</span><span class="mi">4</span><span class="n">pZoY9gYTgLeKmvejpqzgChg8ElExSJr</span><span class="p">)</span> <span class="c1"># POLYGON_API_KEY is used</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">RESTClient</span><span class="p">(</span> <span class="s2">&quot;4pZoY9gYTgLeKmvejpqzgChg8ElExSJr&quot;</span> <span class="p">)</span> <span class="c1"># api_key is used</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AuthError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/Users/josh/APCSP/_notebooks/2022-10-10-Ubuntu.ipynb Cell 3</span> in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/josh/APCSP/_notebooks/2022-10-10-Ubuntu.ipynb#W0sZmlsZQ%3D%3D?line=0&#39;&gt;1&lt;/a&gt;</span> client = RESTClient() # POLYGON_API_KEY is used
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/josh/APCSP/_notebooks/2022-10-10-Ubuntu.ipynb#W0sZmlsZQ%3D%3D?line=1&#39;&gt;2&lt;/a&gt;</span> client = RESTClient( &#34;4pZoY9gYTgLeKmvejpqzgChg8ElExSJr&#34; )

File <span class="ansi-green-fg">~/opt/anaconda3/lib/python3.9/site-packages/polygon/rest/__init__.py:48</span>, in <span class="ansi-cyan-fg">RESTClient.__init__</span><span class="ansi-blue-fg">(self, api_key, connect_timeout, read_timeout, num_pools, retries, base, verbose)</span>
<span class="ansi-green-intense-fg ansi-bold">     38</span> def __init__(
<span class="ansi-green-intense-fg ansi-bold">     39</span>     self,
<span class="ansi-green-intense-fg ansi-bold">     40</span>     api_key: Optional[str] = os.getenv(ENV_KEY),
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     46</span>     verbose: bool = False,
<span class="ansi-green-intense-fg ansi-bold">     47</span> ):
<span class="ansi-green-fg">---&gt; 48</span>     super().__init__(
<span class="ansi-green-intense-fg ansi-bold">     49</span>         api_key=api_key,
<span class="ansi-green-intense-fg ansi-bold">     50</span>         connect_timeout=connect_timeout,
<span class="ansi-green-intense-fg ansi-bold">     51</span>         read_timeout=read_timeout,
<span class="ansi-green-intense-fg ansi-bold">     52</span>         num_pools=num_pools,
<span class="ansi-green-intense-fg ansi-bold">     53</span>         retries=retries,
<span class="ansi-green-intense-fg ansi-bold">     54</span>         base=base,
<span class="ansi-green-intense-fg ansi-bold">     55</span>         verbose=verbose,
<span class="ansi-green-intense-fg ansi-bold">     56</span>     )
<span class="ansi-green-intense-fg ansi-bold">     57</span>     self.vx = VXClient(
<span class="ansi-green-intense-fg ansi-bold">     58</span>         api_key=api_key,
<span class="ansi-green-intense-fg ansi-bold">     59</span>         connect_timeout=connect_timeout,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     64</span>         verbose=verbose,
<span class="ansi-green-intense-fg ansi-bold">     65</span>     )

File <span class="ansi-green-fg">~/opt/anaconda3/lib/python3.9/site-packages/polygon/rest/base.py:33</span>, in <span class="ansi-cyan-fg">BaseClient.__init__</span><span class="ansi-blue-fg">(self, api_key, connect_timeout, read_timeout, num_pools, retries, base, verbose)</span>
<span class="ansi-green-intense-fg ansi-bold">     22</span> def __init__(
<span class="ansi-green-intense-fg ansi-bold">     23</span>     self,
<span class="ansi-green-intense-fg ansi-bold">     24</span>     api_key: Optional[str],
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     30</span>     verbose: bool,
<span class="ansi-green-intense-fg ansi-bold">     31</span> ):
<span class="ansi-green-intense-fg ansi-bold">     32</span>     if api_key is None:
<span class="ansi-green-fg">---&gt; 33</span>         raise AuthError(
<span class="ansi-green-intense-fg ansi-bold">     34</span>             f&#34;Must specify env var POLYGON_API_KEY or pass api_key in constructor&#34;
<span class="ansi-green-intense-fg ansi-bold">     35</span>         )
<span class="ansi-green-intense-fg ansi-bold">     36</span>     self.API_KEY = api_key
<span class="ansi-green-intense-fg ansi-bold">     37</span>     self.BASE = base

<span class="ansi-red-fg">AuthError</span>: Must specify env var POLYGON_API_KEY or pass api_key in constructor</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">polygon</span> <span class="kn">import</span> <span class="n">RESTClient</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">RESTClient</span><span class="p">()</span>

<span class="n">aggs</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_aggs</span><span class="p">(</span><span class="s2">&quot;AAPL&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;day&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-04-04&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-04-04&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aggs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AuthError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/Users/josh/APCSP/_notebooks/2022-10-10-Ubuntu.ipynb Cell 3</span> in <span class="ansi-cyan-fg">&lt;cell line: 3&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/josh/APCSP/_notebooks/2022-10-10-Ubuntu.ipynb#W1sZmlsZQ%3D%3D?line=0&#39;&gt;1&lt;/a&gt;</span> from polygon import RESTClient
<span class="ansi-green-fg">----&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/josh/APCSP/_notebooks/2022-10-10-Ubuntu.ipynb#W1sZmlsZQ%3D%3D?line=2&#39;&gt;3&lt;/a&gt;</span> client = RESTClient()
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/josh/APCSP/_notebooks/2022-10-10-Ubuntu.ipynb#W1sZmlsZQ%3D%3D?line=4&#39;&gt;5&lt;/a&gt;</span> aggs = client.get_aggs(&#34;AAPL&#34;, 1, &#34;day&#34;, &#34;2022-04-04&#34;, &#34;2022-04-04&#34;)
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/josh/APCSP/_notebooks/2022-10-10-Ubuntu.ipynb#W1sZmlsZQ%3D%3D?line=5&#39;&gt;6&lt;/a&gt;</span> print(aggs)

File <span class="ansi-green-fg">~/opt/anaconda3/lib/python3.9/site-packages/polygon/rest/__init__.py:48</span>, in <span class="ansi-cyan-fg">RESTClient.__init__</span><span class="ansi-blue-fg">(self, api_key, connect_timeout, read_timeout, num_pools, retries, base, verbose)</span>
<span class="ansi-green-intense-fg ansi-bold">     38</span> def __init__(
<span class="ansi-green-intense-fg ansi-bold">     39</span>     self,
<span class="ansi-green-intense-fg ansi-bold">     40</span>     api_key: Optional[str] = os.getenv(ENV_KEY),
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     46</span>     verbose: bool = False,
<span class="ansi-green-intense-fg ansi-bold">     47</span> ):
<span class="ansi-green-fg">---&gt; 48</span>     super().__init__(
<span class="ansi-green-intense-fg ansi-bold">     49</span>         api_key=api_key,
<span class="ansi-green-intense-fg ansi-bold">     50</span>         connect_timeout=connect_timeout,
<span class="ansi-green-intense-fg ansi-bold">     51</span>         read_timeout=read_timeout,
<span class="ansi-green-intense-fg ansi-bold">     52</span>         num_pools=num_pools,
<span class="ansi-green-intense-fg ansi-bold">     53</span>         retries=retries,
<span class="ansi-green-intense-fg ansi-bold">     54</span>         base=base,
<span class="ansi-green-intense-fg ansi-bold">     55</span>         verbose=verbose,
<span class="ansi-green-intense-fg ansi-bold">     56</span>     )
<span class="ansi-green-intense-fg ansi-bold">     57</span>     self.vx = VXClient(
<span class="ansi-green-intense-fg ansi-bold">     58</span>         api_key=api_key,
<span class="ansi-green-intense-fg ansi-bold">     59</span>         connect_timeout=connect_timeout,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     64</span>         verbose=verbose,
<span class="ansi-green-intense-fg ansi-bold">     65</span>     )

File <span class="ansi-green-fg">~/opt/anaconda3/lib/python3.9/site-packages/polygon/rest/base.py:33</span>, in <span class="ansi-cyan-fg">BaseClient.__init__</span><span class="ansi-blue-fg">(self, api_key, connect_timeout, read_timeout, num_pools, retries, base, verbose)</span>
<span class="ansi-green-intense-fg ansi-bold">     22</span> def __init__(
<span class="ansi-green-intense-fg ansi-bold">     23</span>     self,
<span class="ansi-green-intense-fg ansi-bold">     24</span>     api_key: Optional[str],
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     30</span>     verbose: bool,
<span class="ansi-green-intense-fg ansi-bold">     31</span> ):
<span class="ansi-green-intense-fg ansi-bold">     32</span>     if api_key is None:
<span class="ansi-green-fg">---&gt; 33</span>         raise AuthError(
<span class="ansi-green-intense-fg ansi-bold">     34</span>             f&#34;Must specify env var POLYGON_API_KEY or pass api_key in constructor&#34;
<span class="ansi-green-intense-fg ansi-bold">     35</span>         )
<span class="ansi-green-intense-fg ansi-bold">     36</span>     self.API_KEY = api_key
<span class="ansi-green-intense-fg ansi-bold">     37</span>     self.BASE = base

<span class="ansi-red-fg">AuthError</span>: Must specify env var POLYGON_API_KEY or pass api_key in constructor</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">polygon</span> <span class="kn">import</span> <span class="n">RESTClient</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">RESTClient</span><span class="p">()</span>

<span class="n">trades</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">list_trades</span><span class="p">(</span><span class="s2">&quot;AAA&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-04-04&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">trades</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trades</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AuthError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/Users/josh/APCSP/_notebooks/2022-10-10-Ubuntu.ipynb Cell 4</span> in <span class="ansi-cyan-fg">&lt;cell line: 3&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/josh/APCSP/_notebooks/2022-10-10-Ubuntu.ipynb#W2sZmlsZQ%3D%3D?line=0&#39;&gt;1&lt;/a&gt;</span> from polygon import RESTClient
<span class="ansi-green-fg">----&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/josh/APCSP/_notebooks/2022-10-10-Ubuntu.ipynb#W2sZmlsZQ%3D%3D?line=2&#39;&gt;3&lt;/a&gt;</span> client = RESTClient()
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/josh/APCSP/_notebooks/2022-10-10-Ubuntu.ipynb#W2sZmlsZQ%3D%3D?line=4&#39;&gt;5&lt;/a&gt;</span> trades = []
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/josh/APCSP/_notebooks/2022-10-10-Ubuntu.ipynb#W2sZmlsZQ%3D%3D?line=5&#39;&gt;6&lt;/a&gt;</span> for t in client.list_trades(&#34;AAA&#34;, &#34;2022-04-04&#34;, limit=5):

File <span class="ansi-green-fg">~/opt/anaconda3/lib/python3.9/site-packages/polygon/rest/__init__.py:48</span>, in <span class="ansi-cyan-fg">RESTClient.__init__</span><span class="ansi-blue-fg">(self, api_key, connect_timeout, read_timeout, num_pools, retries, base, verbose)</span>
<span class="ansi-green-intense-fg ansi-bold">     38</span> def __init__(
<span class="ansi-green-intense-fg ansi-bold">     39</span>     self,
<span class="ansi-green-intense-fg ansi-bold">     40</span>     api_key: Optional[str] = os.getenv(ENV_KEY),
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     46</span>     verbose: bool = False,
<span class="ansi-green-intense-fg ansi-bold">     47</span> ):
<span class="ansi-green-fg">---&gt; 48</span>     super().__init__(
<span class="ansi-green-intense-fg ansi-bold">     49</span>         api_key=api_key,
<span class="ansi-green-intense-fg ansi-bold">     50</span>         connect_timeout=connect_timeout,
<span class="ansi-green-intense-fg ansi-bold">     51</span>         read_timeout=read_timeout,
<span class="ansi-green-intense-fg ansi-bold">     52</span>         num_pools=num_pools,
<span class="ansi-green-intense-fg ansi-bold">     53</span>         retries=retries,
<span class="ansi-green-intense-fg ansi-bold">     54</span>         base=base,
<span class="ansi-green-intense-fg ansi-bold">     55</span>         verbose=verbose,
<span class="ansi-green-intense-fg ansi-bold">     56</span>     )
<span class="ansi-green-intense-fg ansi-bold">     57</span>     self.vx = VXClient(
<span class="ansi-green-intense-fg ansi-bold">     58</span>         api_key=api_key,
<span class="ansi-green-intense-fg ansi-bold">     59</span>         connect_timeout=connect_timeout,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     64</span>         verbose=verbose,
<span class="ansi-green-intense-fg ansi-bold">     65</span>     )

File <span class="ansi-green-fg">~/opt/anaconda3/lib/python3.9/site-packages/polygon/rest/base.py:33</span>, in <span class="ansi-cyan-fg">BaseClient.__init__</span><span class="ansi-blue-fg">(self, api_key, connect_timeout, read_timeout, num_pools, retries, base, verbose)</span>
<span class="ansi-green-intense-fg ansi-bold">     22</span> def __init__(
<span class="ansi-green-intense-fg ansi-bold">     23</span>     self,
<span class="ansi-green-intense-fg ansi-bold">     24</span>     api_key: Optional[str],
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     30</span>     verbose: bool,
<span class="ansi-green-intense-fg ansi-bold">     31</span> ):
<span class="ansi-green-intense-fg ansi-bold">     32</span>     if api_key is None:
<span class="ansi-green-fg">---&gt; 33</span>         raise AuthError(
<span class="ansi-green-intense-fg ansi-bold">     34</span>             f&#34;Must specify env var POLYGON_API_KEY or pass api_key in constructor&#34;
<span class="ansi-green-intense-fg ansi-bold">     35</span>         )
<span class="ansi-green-intense-fg ansi-bold">     36</span>     self.API_KEY = api_key
<span class="ansi-green-intense-fg ansi-bold">     37</span>     self.BASE = base

<span class="ansi-red-fg">AuthError</span>: Must specify env var POLYGON_API_KEY or pass api_key in constructor</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">polygon.rest.models</span> <span class="kn">import</span> <span class="n">Sort</span>

<span class="n">client</span><span class="o">.</span><span class="n">list_trades</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="n">Sort</span><span class="o">.</span><span class="n">ASC</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">polygon</span> <span class="kn">import</span> <span class="n">RESTClient</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">cast</span>
<span class="kn">from</span> <span class="nn">urllib3</span> <span class="kn">import</span> <span class="n">HTTPResponse</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">RESTClient</span><span class="p">()</span>

<span class="n">aggs</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
    <span class="n">HTTPResponse</span><span class="p">,</span>
    <span class="n">client</span><span class="o">.</span><span class="n">get_aggs</span><span class="p">(</span>
        <span class="s2">&quot;AAPL&quot;</span><span class="p">,</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;day&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2022-04-01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2022-04-04&quot;</span><span class="p">,</span>
        <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aggs</span><span class="o">.</span><span class="n">geturl</span><span class="p">())</span>
<span class="c1"># https://api.polygon.io/v2/aggs/ticker/AAPL/range/1/day/2022-04-01/2022-04-04</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aggs</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
<span class="c1"># 200</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aggs</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># b&#39;{</span>
<span class="c1">#    &quot;ticker&quot;: &quot;AAPL&quot;,</span>
<span class="c1">#    &quot;queryCount&quot;: 2,</span>
<span class="c1">#    &quot;resultsCount&quot;: 2,</span>
<span class="c1">#    &quot;adjusted&quot;: true,</span>
<span class="c1">#    &quot;results&quot;: [</span>
<span class="c1">#      {</span>
<span class="c1">#        &quot;v&quot;: 78251328,</span>
<span class="c1">#        &quot;vw&quot;: 173.4143,</span>
<span class="c1">#        &quot;o&quot;: 174.03,</span>
<span class="c1">#        &quot;c&quot;: 174.31,</span>
<span class="c1">#        &quot;h&quot;: 174.88,</span>
<span class="c1">#        &quot;l&quot;: 171.94,</span>
<span class="c1">#        &quot;t&quot;: 1648785600000,</span>
<span class="c1">#        &quot;n&quot;: 661160</span>
<span class="c1">#      },</span>
<span class="c1">#      {</span>
<span class="c1">#        &quot;v&quot;: 76545983,</span>
<span class="c1">#        &quot;vw&quot;: 177.4855,</span>
<span class="c1">#        &quot;o&quot;: 174.57,</span>
<span class="c1">#        &quot;c&quot;: 178.44,</span>
<span class="c1">#        &quot;h&quot;: 178.49,</span>
<span class="c1">#        &quot;l&quot;: 174.44,</span>
<span class="c1">#        &quot;t&quot;: 1649044800000,</span>
<span class="c1">#        &quot;n&quot;: 630374</span>
<span class="c1">#      }</span>
<span class="c1">#    ],</span>
<span class="c1">#    &quot;status&quot;: &quot;OK&quot;,</span>
<span class="c1">#    &quot;request_id&quot;: &quot;d8882a9d5194978819777f49c44b09c6&quot;,</span>
<span class="c1">#    &quot;count&quot;: 2</span>
<span class="c1">#  }&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">polygon</span> <span class="kn">import</span> <span class="n">RESTClient</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">cast</span>
<span class="kn">from</span> <span class="nn">urllib3</span> <span class="kn">import</span> <span class="n">HTTPResponse</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">RESTClient</span><span class="p">()</span>

<span class="n">trades</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
    <span class="n">HTTPResponse</span><span class="p">,</span>
    <span class="n">client</span><span class="o">.</span><span class="n">list_trades</span><span class="p">(</span><span class="s2">&quot;AAA&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-04-20&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trades</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># b&#39;{</span>
<span class="c1">#  &quot;results&quot;: [</span>
<span class="c1">#    {</span>
<span class="c1">#      &quot;conditions&quot;: [</span>
<span class="c1">#        15</span>
<span class="c1">#      ],</span>
<span class="c1">#      &quot;exchange&quot;: 11,</span>
<span class="c1">#      &quot;id&quot;: &quot;52983575627601&quot;,</span>
<span class="c1">#      &quot;participant_timestamp&quot;: 1650499200029279200,</span>
<span class="c1">#      &quot;price&quot;: 24.875,</span>
<span class="c1">#      &quot;sequence_number&quot;: 1591291,</span>
<span class="c1">#      &quot;sip_timestamp&quot;: 1650499200029316600,</span>
<span class="c1">#      &quot;size&quot;: 100,</span>
<span class="c1">#      &quot;tape&quot;: 1</span>
<span class="c1">#    },</span>
<span class="c1">#    {</span>
<span class="c1">#      &quot;conditions&quot;: [</span>
<span class="c1">#        38,</span>
<span class="c1">#        41</span>
<span class="c1">#      ],</span>
<span class="c1">#      &quot;exchange&quot;: 11,</span>
<span class="c1">#      &quot;id&quot;: &quot;52983575627600&quot;,</span>
<span class="c1">#      &quot;participant_timestamp&quot;: 1650499200029279200,</span>
<span class="c1">#      &quot;price&quot;: 24.875,</span>
<span class="c1">#      &quot;sequence_number&quot;: 1591290,</span>
<span class="c1">#      &quot;sip_timestamp&quot;: 1650499200029316600,</span>
<span class="c1">#      &quot;tape&quot;: 1</span>
<span class="c1">#    },</span>
<span class="c1">#    {</span>
<span class="c1">#      &quot;conditions&quot;: [</span>
<span class="c1">#        15</span>
<span class="c1">#      ],</span>
<span class="c1">#      &quot;exchange&quot;: 11,</span>
<span class="c1">#      &quot;id&quot;: &quot;52983575622470&quot;,</span>
<span class="c1">#      &quot;participant_timestamp&quot;: 1650493800003024000,</span>
<span class="c1">#      &quot;price&quot;: 24.875,</span>
<span class="c1">#      &quot;sequence_number&quot;: 1571279,</span>
<span class="c1">#      &quot;sip_timestamp&quot;: 1650493800003645400,</span>
<span class="c1">#      &quot;size&quot;: 100,</span>
<span class="c1">#      &quot;tape&quot;: 1</span>
<span class="c1">#    },</span>
<span class="c1">#    {</span>
<span class="c1">#      &quot;conditions&quot;: [</span>
<span class="c1">#        38,</span>
<span class="c1">#        41</span>
<span class="c1">#      ],</span>
<span class="c1">#      &quot;exchange&quot;: 11,</span>
<span class="c1">#      &quot;id&quot;: &quot;52983575622469&quot;,</span>
<span class="c1">#      &quot;participant_timestamp&quot;: 1650493800003024000,</span>
<span class="c1">#      &quot;price&quot;: 24.875,</span>
<span class="c1">#      &quot;sequence_number&quot;: 1571276,</span>
<span class="c1">#      &quot;sip_timestamp&quot;: 1650493800003635500,</span>
<span class="c1">#      &quot;tape&quot;: 1</span>
<span class="c1">#    },</span>
<span class="c1">#    {</span>
<span class="c1">#      &quot;conditions&quot;: [</span>
<span class="c1">#        15</span>
<span class="c1">#      ],</span>
<span class="c1">#      &quot;exchange&quot;: 11,</span>
<span class="c1">#      &quot;id&quot;: &quot;52983575556178&quot;,</span>
<span class="c1">#      &quot;participant_timestamp&quot;: 1650485400002987800,</span>
<span class="c1">#      &quot;price&quot;: 24.875,</span>
<span class="c1">#      &quot;sequence_number&quot;: 1536223,</span>
<span class="c1">#      &quot;sip_timestamp&quot;: 1650485400003870000,</span>
<span class="c1">#      &quot;size&quot;: 100,</span>
<span class="c1">#      &quot;tape&quot;: 1</span>
<span class="c1">#    }</span>
<span class="c1">#  ],</span>
<span class="c1">#  &quot;status&quot;: &quot;OK&quot;,</span>
<span class="c1">#  &quot;request_id&quot;: &quot;618bb99e7a632ed9f55454a541404b44&quot;,</span>
<span class="c1">#  &quot;next_url&quot;: &quot;https://api.polygon.io/v3/trades/AAA?cursor=YXA9NSZhcz0mbGltaXQ9NSZvcmRlcj1kZXNjJnNvcnQ9dGltZXN0YW1wJnRpbWVzdGFtcC5ndGU9MjAyMi0wNC0yMFQwNCUzQTAwJTNBMDBaJnRpbWVzdGFtcC5sdGU9MjAyMi0wNC0yMFQyMCUzQTEwJTNBMDAuMDAzODY5OTUyWg&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">polygon</span> <span class="kn">import</span> <span class="n">WebSocketClient</span>
<span class="kn">from</span> <span class="nn">polygon.websocket.models</span> <span class="kn">import</span> <span class="n">WebSocketMessage</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">WebSocketClient</span><span class="p">(</span><span class="n">subscriptions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;T.*&quot;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">handle_msg</span><span class="p">(</span><span class="n">msgs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">WebSocketMessage</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">msgs</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>


<span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">handle_msg</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">polygon</span> <span class="kn">import</span> <span class="n">WebSocketClient</span>
<span class="kn">from</span> <span class="nn">polygon.websocket.models</span> <span class="kn">import</span> <span class="n">WebSocketMessage</span><span class="p">,</span> <span class="n">EquityTrade</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">WebSocketClient</span><span class="p">(</span><span class="n">subscriptions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;T.*&quot;</span><span class="p">])</span>


<span class="k">class</span> <span class="nc">MessageHandler</span><span class="p">:</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">handle_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msgs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">WebSocketMessage</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">msgs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="n">EquityTrade</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="n">h</span> <span class="o">=</span> <span class="n">MessageHandler</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">handle_msg</span><span class="p">(</span><span class="n">msgs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">WebSocketMessage</span><span class="p">]):</span>
    <span class="n">h</span><span class="o">.</span><span class="n">handle_msg</span><span class="p">(</span><span class="n">msgs</span><span class="p">)</span>


<span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">handle_msg</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">polygon</span> <span class="kn">import</span> <span class="n">WebSocketClient</span>
<span class="kn">from</span> <span class="nn">polygon.websocket.models</span> <span class="kn">import</span> <span class="n">WebSocketMessage</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="kn">import</span> <span class="nn">asyncio</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">WebSocketClient</span><span class="p">(</span><span class="n">subscriptions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;T.*&quot;</span><span class="p">])</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">handle_msg</span><span class="p">(</span><span class="n">msgs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">WebSocketMessage</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">msgs</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">timeout</span><span class="p">():</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;unsubscribe_all&quot;</span><span class="p">)</span>
    <span class="n">c</span><span class="o">.</span><span class="n">unsubscribe_all</span><span class="p">()</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;close&quot;</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">c</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">handle_msg</span><span class="p">),</span> <span class="n">timeout</span><span class="p">())</span>


<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">polygon</span> <span class="kn">import</span> <span class="n">WebSocketClient</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">WebSocketClient</span><span class="p">(</span><span class="n">subscriptions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;T.*&quot;</span><span class="p">],</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">handle_msg</span><span class="p">(</span><span class="n">msgs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">msgs</span><span class="p">))</span>


<span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">handle_msg</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

